{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"beams-collision","type":"registry:ui","title":"Beams Collision","author":"shadcn.io","description":"Light beams that fall and explode into particles on impact, creating a satisfying rain-like effect with indigo and purple gradients","homepage":"https://www.shadcn.io/background/beams-collision","files":[{"type":"registry:ui","path":"beams-collision.tsx","content":"\"use client\"\n\nimport { AnimatePresence, motion } from \"framer-motion\"\nimport React, { useEffect, useRef, useState } from \"react\"\nimport { cn } from \"~/lib/utils\"\n\nexport const BackgroundBeamsWithCollision = ({\n  children,\n  className,\n}: {\n  children: React.ReactNode\n  className?: string\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null)\n  const parentRef = useRef<HTMLDivElement>(null)\n\n  const beams = [\n    { initialX: 10, translateX: 10, duration: 5, repeatDelay: 2, delay: 0 },\n    { initialX: 100, translateX: 100, duration: 4, repeatDelay: 3, delay: 0.2, className: \"h-6\" },\n    { initialX: 200, translateX: 200, duration: 6, repeatDelay: 2, delay: 0.4 },\n    { initialX: 300, translateX: 300, duration: 5, repeatDelay: 4, delay: 0.6, className: \"h-12\" },\n    { initialX: 400, translateX: 400, duration: 4, repeatDelay: 3, delay: 0.8 },\n    { initialX: 500, translateX: 500, duration: 7, repeatDelay: 2, delay: 1.0, className: \"h-20\" },\n    { initialX: 600, translateX: 600, duration: 5, repeatDelay: 3, delay: 1.2 },\n    { initialX: 700, translateX: 700, duration: 4, repeatDelay: 4, delay: 1.4, className: \"h-6\" },\n    { initialX: 800, translateX: 800, duration: 6, repeatDelay: 2, delay: 1.6 },\n    { initialX: 900, translateX: 900, duration: 5, repeatDelay: 3, delay: 1.8, className: \"h-12\" },\n    { initialX: 1000, translateX: 1000, duration: 4, repeatDelay: 2, delay: 2.0 },\n    {\n      initialX: 1100,\n      translateX: 1100,\n      duration: 6,\n      repeatDelay: 3,\n      delay: 2.2,\n      className: \"h-20\",\n    },\n    { initialX: 1200, translateX: 1200, duration: 5, repeatDelay: 4, delay: 2.4 },\n    { initialX: 1300, translateX: 1300, duration: 4, repeatDelay: 2, delay: 2.6, className: \"h-6\" },\n    { initialX: 1400, translateX: 1400, duration: 7, repeatDelay: 3, delay: 2.8 },\n  ]\n\n  return (\n    <div\n      className={cn(\n        \"relative flex h-full w-full items-center justify-center overflow-hidden bg-neutral-950\",\n        className,\n      )}\n      ref={parentRef}\n    >\n      {beams.map(beam => (\n        <CollisionMechanism\n          beamOptions={beam}\n          containerRef={containerRef}\n          key={`${beam.initialX}beam-idx`}\n          parentRef={parentRef}\n        />\n      ))}\n\n      {children}\n      <div\n        className=\"pointer-events-none absolute inset-x-0 bottom-0 h-px w-full bg-neutral-800\"\n        ref={containerRef}\n      />\n    </div>\n  )\n}\n\nconst CollisionMechanism = React.forwardRef<\n  HTMLDivElement,\n  {\n    containerRef: React.RefObject<HTMLDivElement | null>\n    parentRef: React.RefObject<HTMLDivElement | null>\n    beamOptions?: {\n      initialX?: number\n      translateX?: number\n      initialY?: number\n      translateY?: number\n      rotate?: number\n      className?: string\n      duration?: number\n      delay?: number\n      repeatDelay?: number\n    }\n  }\n>(({ parentRef, containerRef, beamOptions = {} }, _ref) => {\n  const beamRef = useRef<HTMLDivElement>(null)\n  const [collision, setCollision] = useState<{\n    detected: boolean\n    coordinates: { x: number; y: number } | null\n  }>({\n    detected: false,\n    coordinates: null,\n  })\n  const [beamKey, setBeamKey] = useState(0)\n  const [cycleCollisionDetected, setCycleCollisionDetected] = useState(false)\n\n  useEffect(() => {\n    const checkCollision = () => {\n      if (beamRef.current && containerRef.current && parentRef.current && !cycleCollisionDetected) {\n        const beamRect = beamRef.current.getBoundingClientRect()\n        const containerRect = containerRef.current.getBoundingClientRect()\n        const parentRect = parentRef.current.getBoundingClientRect()\n\n        if (beamRect.bottom >= containerRect.top) {\n          const relativeX = beamRect.left - parentRect.left + beamRect.width / 2\n          const relativeY = beamRect.bottom - parentRect.top\n\n          setCollision({\n            detected: true,\n            coordinates: {\n              x: relativeX,\n              y: relativeY,\n            },\n          })\n          setCycleCollisionDetected(true)\n        }\n      }\n    }\n\n    const animationInterval = setInterval(checkCollision, 50)\n\n    return () => clearInterval(animationInterval)\n  }, [cycleCollisionDetected, containerRef])\n\n  useEffect(() => {\n    if (collision.detected && collision.coordinates) {\n      setTimeout(() => {\n        setCollision({ detected: false, coordinates: null })\n        setCycleCollisionDetected(false)\n      }, 2000)\n\n      setTimeout(() => {\n        setBeamKey(prevKey => prevKey + 1)\n      }, 2000)\n    }\n  }, [collision])\n\n  return (\n    <>\n      <motion.div\n        animate=\"animate\"\n        className={cn(\n          \"absolute left-0 top-20 m-auto h-14 w-px rounded-full bg-gradient-to-t from-indigo-500 via-purple-500 to-transparent\",\n          beamOptions.className,\n        )}\n        initial={{\n          translateY: beamOptions.initialY || \"-200px\",\n          translateX: beamOptions.initialX || \"0px\",\n          rotate: beamOptions.rotate || 0,\n        }}\n        key={beamKey}\n        ref={beamRef}\n        transition={{\n          duration: beamOptions.duration || 8,\n          repeat: Number.POSITIVE_INFINITY,\n          repeatType: \"loop\",\n          ease: \"linear\",\n          delay: beamOptions.delay || 0,\n          repeatDelay: beamOptions.repeatDelay || 0,\n        }}\n        variants={{\n          animate: {\n            translateY: beamOptions.translateY || \"1800px\",\n            translateX: beamOptions.translateX || \"0px\",\n            rotate: beamOptions.rotate || 0,\n          },\n        }}\n      />\n      <AnimatePresence>\n        {collision.detected && collision.coordinates && (\n          <Explosion\n            className=\"\"\n            key={`${collision.coordinates.x}-${collision.coordinates.y}`}\n            style={{\n              left: `${collision.coordinates.x}px`,\n              top: `${collision.coordinates.y}px`,\n              transform: \"translate(-50%, -50%)\",\n            }}\n          />\n        )}\n      </AnimatePresence>\n    </>\n  )\n})\n\nCollisionMechanism.displayName = \"CollisionMechanism\"\n\nconst Explosion = ({ ...props }: React.HTMLProps<HTMLDivElement>) => {\n  const spans = Array.from({ length: 20 }, (_, index) => ({\n    id: index,\n    initialX: 0,\n    initialY: 0,\n    directionX: Math.floor(Math.random() * 80 - 40),\n    directionY: Math.floor(Math.random() * -50 - 10),\n  }))\n\n  return (\n    <div {...(props as any)} className={cn(\"absolute z-50 h-2 w-2\", props.className)}>\n      <motion.div\n        animate={{ opacity: 1 }}\n        className=\"absolute -inset-x-10 top-0 m-auto h-2 w-10 rounded-full bg-gradient-to-r from-transparent via-indigo-500 to-transparent blur-sm\"\n        exit={{ opacity: 0 }}\n        initial={{ opacity: 0 }}\n        transition={{ duration: 1.5, ease: \"easeOut\" }}\n      />\n      {spans.map(span => (\n        <motion.span\n          animate={{\n            x: span.directionX,\n            y: span.directionY,\n            opacity: 0,\n          }}\n          className=\"absolute h-1 w-1 rounded-full bg-gradient-to-b from-indigo-500 to-purple-500\"\n          initial={{ x: span.initialX, y: span.initialY, opacity: 1 }}\n          key={span.id}\n          transition={{ duration: Math.random() * 1.5 + 0.5, ease: \"easeOut\" }}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default function BackgroundBeamsWithCollisionDemo() {\n  return (\n    <div className=\"h-screen w-screen\">\n      <BackgroundBeamsWithCollision>\n        <div className=\"pointer-events-none\" />\n      </BackgroundBeamsWithCollision>\n    </div>\n  )\n}\n","target":"components/ui/beams-collision.tsx"}],"dependencies":["framer-motion"]}